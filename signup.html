<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="UTF-8" />

        <title>GBA Online - Sign Up</title>

        <link rel="stylesheet" href="./stylesheets/signin.css" />
    </head>

    <body>
        <!-- partial:index.partial.html -->

        <section>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>
            <span></span> <span></span> <span></span> <span></span>

            <div class="signin">
                <div class="content">
                    <div class="d-flex">
                        <figure class="reverted-horizontal d-inline">
                            <img
                                src="./assets/gif/characters/knuckles.gif"
                                alt=""
                                width="400"
                                height="200"
                            />
                        </figure>
                        <figure class="d-inline">
                            <img
                                src="./assets/gif/gameboy/flying-gameboy.gif"
                                alt=""
                                width="400"
                                height="200"
                            />
                        </figure>
                        <figure class="d-inline">
                            <img
                                src="./assets/gif/characters/knuckles.gif"
                                alt=""
                                width="400"
                                height="200"
                            />
                        </figure>
                    </div>
                    <h2>Sign Up</h2>

                    <div class="form">
                        <div class="inputBox">
                            <input id="control_username" type="text" required /> <i>Username</i>
                        </div>

                        <div class="inputBox">
                            <input id="control_encryption_key" type="text" required /> <i>Encryption Key</i>
                        </div>

                        <div class="inputBox">
                            <input id="control_password" type="password" required /> <i>Password</i>
                        </div>

                        <div class="inputBox">
                            <input id="control_confirm_password" type="password" required /> <i>Confirm Password</i>
                        </div>

                        <div class="links">
                            <!--<a href="#">Forgot Password</a>-->
                            <a href="/signin.html">Sign In</a>
                        </div>

                        <div class="inputBox">
                            <input id="btnSend" type="submit" value="Send" />
                            <input id="showUsers" type="submit" value="Send" />
                            <input id="deleteAll" type="submit" value="Send" />
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- partial -->
        <!--<script src="/modules/user/account.js" type="module"></script>-->
        <script type="module">
            import { createAccount, getAllUsers, deleteAllUsers } from '/modules/user/account.js';

            const PAGE_CONTROLS = {
                'Username': document.getElementById('control_username'),
                'EncryptionKey': document.getElementById('control_encryption_key'),
                'Password': document.getElementById('control_password'),
                'ConfirmPassword': document.getElementById('control_confirm_password'),
                'SubmitButton': document.getElementById('btnSend'),
                'ShowButton': document.getElementById('showUsers'),
                'DeleteButton': document.getElementById('deleteAll'),
            };

            const MESSAGES = {
                'PasswordsDontMatch': "Passwords don't match",
            };

            const checkPassword = () => {
                if(PAGE_CONTROLS.Password.value != PAGE_CONTROLS.ConfirmPassword.value) {
                    alert(MESSAGES.PasswordsDontMatch);
                    return false;
                }else{
                    return true;
                }
            };

            const proceedToCreate = async () => {
                if(await checkPassword()) {
                    const user = {
                        'username': PAGE_CONTROLS.Username.value,
                        'encryptionKey': PAGE_CONTROLS.EncryptionKey.value,
                        'password': PAGE_CONTROLS.Password.value,
                    };

                    createAccount(user);
                }
            };

            PAGE_CONTROLS.SubmitButton.addEventListener('click', () => {
                proceedToCreate();
            });

            PAGE_CONTROLS.ShowButton.addEventListener('click', () => {
                getAllUsers();
            });

            PAGE_CONTROLS.DeleteButton.addEventListener('click', () => {
                deleteAllUsers();
            });
        </script>
    </body>
</html>
